<!DOCTYPE html>
<html>
  <head>
    <title>Camera Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #1a1a1a;
        color: white;
        padding: 20px;
        text-align: center;
      }

      video {
        width: 400px;
        height: 300px;
        background: #000;
        border: 2px solid #4ecdc4;
        border-radius: 8px;
        margin: 20px;
      }

      button {
        background: #4ecdc4;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        margin: 10px;
        font-size: 16px;
      }

      button:hover {
        background: #3bb3b1;
      }

      #error {
        color: #ff6b6b;
        margin: 20px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>Camera & Video Test</h1>
    <p>This page tests if your camera works properly</p>

    <div>
      <button onclick="startCamera()">Start Camera</button>
      <button onclick="stopCamera()">Stop Camera</button>
    </div>

    <video id="localVideo" autoplay muted playsinline></video>

    <div id="error"></div>
    <div id="info">Click "Start Camera" to test your video feed</div>

    <script>
      let stream = null;
      const video = document.getElementById("localVideo");
      const errorDiv = document.getElementById("error");
      const infoDiv = document.getElementById("info");

      async function startCamera() {
        try {
          errorDiv.textContent = "";
          infoDiv.textContent = "Requesting camera access...";

          stream = await navigator.mediaDevices.getUserMedia({
            video: {
              width: { ideal: 1280, min: 640 },
              height: { ideal: 720, min: 480 },
              frameRate: { ideal: 30, min: 15 },
              facingMode: "user",
            },
            audio: true,
          });

          video.srcObject = stream;
          infoDiv.textContent =
            "Camera started successfully! You should see your video above.";

          video.onloadedmetadata = () => {
            video.play().catch((e) => {
              console.error("Error playing video:", e);
              errorDiv.textContent = "Error playing video: " + e.message;
            });
          };
        } catch (error) {
          console.error("Error accessing camera:", error);
          errorDiv.textContent = "Error: " + error.message;

          if (error.name === "NotAllowedError") {
            errorDiv.textContent +=
              " - Please allow camera permissions and try again.";
          } else if (error.name === "NotFoundError") {
            errorDiv.textContent += " - No camera found.";
          }
        }
      }

      function stopCamera() {
        if (stream) {
          stream.getTracks().forEach((track) => track.stop());
          video.srcObject = null;
          infoDiv.textContent = "Camera stopped.";
          stream = null;
        }
      }

      // Test browser support
      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        errorDiv.textContent = "Your browser does not support camera access.";
      }
    </script>
  </body>
</html>
